{
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 500,
    "height": 300,
    "params": [
        {
            "name": "Ancestry_selection",
            "value": "Australian",
            "bind": {
                "input": "select",
                "options": [
                    "Australian",
                    "English",
                    "Irish",
                    "Chinese",
                    "Scottish",
                    "Italian",
                    "Australian Aboriginal",
                    "German",
                    "Indian",
                    "Greek"
                ],
                "labels": [
                    "Australian",
                    "English",
                    "Irish",
                    "Chinese",
                    "Scottish",
                    "Italian",
                    "Australian Aboriginal",
                    "German",
                    "Indian",
                    "Greek"
                ],
                "name": "Ancestry: "
            }
        }
    ]
    ,
    "layer": [
      {
        "data": {
          "url": "data/ancestryStates.csv",
          "format": {
            "type": "csv"
          }
        },
        "transform": [{
          "lookup": "State",
          "from": {
            "data": {
              "url": "data/STE_2021_AUST_GDA2020.json",
              "format": {
                "type": "topojson",
                "feature": "STE_2021_AUST_GDA2020"
              }
            },
            "key": "properties.STE_NAME21"
          },
          "as": "geo"
        },
        {
            "calculate": "(datum.Persons / datum.Total) * 100",
            "as": "% Born"
        },
        {
            "filter": "datum.Ancestry == Ancestry_selection"
        }],
        "projection": {
          "type": "mercator"
        },
        "mark": {
            "type": "geoshape",
            "stroke": "white"
        },
        "encoding": {
          "shape": {"field": "geo", "type": "geojson"}, 
          "color": {
            "field": "% Born",
            "type": "quantitative",
            "scale": {
                "scheme": "reds"
            }
          },
          "tooltip": [
            {"field": "State", "title": "State"},
            {"field": "Ancestry", "title": "Ancestry"},
            {"field": "% Born", "title": "% {} Born", "format": ".2f"}
          ]
        }
      },
      {
        "data": {
          "values":[
            {"state_name": "VIC", "lat":-37, "long":144},
            {"state_name": "NT", "lat":-20, "long":133.5},
            {"state_name": "SA", "lat":-30, "long":135},
            {"state_name": "WA", "lat":-26, "long":122},
            {"state_name": "QLD", "lat":-24, "long":145},
            {"state_name": "NSW", "lat":-32, "long":146},
            {"state_name": "ACT", "lat":-35.7, "long":152},
            {"state_name": "TAS", "lat":-42, "long":143}
          ]
        },
        "projection": {
          "type": "mercator"
        },
        "mark": {
          "type":"text",
          "fill": "blue",
          "fontSize": 12,
          "fontWeight": "bold"
        },
        "encoding":  {
          "latitude": {
            "field": "lat"
          },
          "longitude": {
            "field": "long"
          },
          "text": {
            "field": "state_name"
          }
        }
      }
    ]
    
  }